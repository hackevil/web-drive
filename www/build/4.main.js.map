{"version":3,"sources":["../../src/pages/main/main.module.ts","../../src/pages/main/main.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACd;AAalC,IAAa,cAAc;IAA3B;IAA6B,CAAC;IAAD,qBAAC;AAAD,CAAC;AAAjB,cAAc;IAX1B,sFAAQ,CAAC;QACR,YAAY,EAAE;YACZ,uDAAQ;SACT;QACD,OAAO,EAAE;YACP,sEAAe,CAAC,QAAQ,CAAC,uDAAQ,CAAC;SACnC;QACD,OAAO,EAAE;YACP,uDAAQ;SACT;KACF,CAAC;GACW,cAAc,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;ACfwB;AACiD;AAChB;AACK;AAOzF,IAAa,QAAQ;IAQnB,kBAAoB,IAAyB,EAAU,IAAyB,EAC7D,OAAsB,EAAU,WAA8B,EAC7D,SAA0B;QAF1B,SAAI,GAAJ,IAAI,CAAqB;QAAU,SAAI,GAAJ,IAAI,CAAqB;QAC7D,YAAO,GAAP,OAAO,CAAe;QAAU,gBAAW,GAAX,WAAW,CAAmB;QAC7D,cAAS,GAAT,SAAS,CAAiB;QANvC,eAAU,GAAG,WAAW,CAAC;QAO9B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;IACxC,CAAC;IAED,4BAAS,GAAT;QAAA,iBAMC;QALC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,uFAAS,CAAC,OAAO,CAAC;QACpC,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,IAAI,CAAC,SAAS,CACf,cAAM,YAAI,CAAC,cAAc,CAAC,4BAA4B,EAAE,8BAA8B,CAAC,EAAjF,CAAiF,CAAC,CAAC;QAC7F,IAAI,CAAC,WAAW,EAAE,CAAC;IACrB,CAAC;IAED,4BAAS,GAAT;QAAA,iBAMC;QALC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,uFAAS,CAAC,KAAK,CAAC;QAClC,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,IAAI,EAC1B,cAAM,YAAI,CAAC,cAAc,CAAC,4BAA4B,EAAE,8BAA8B,CAAC,EAAjF,CAAiF,CAAC,CAAC;QAC7F,IAAI,CAAC,WAAW,EAAE,CAAC;IACrB,CAAC;IAEO,iCAAc,GAAtB;QACE,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC;QAC1B,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,OAAO,GAAG,EAAE,CAAC;QACrC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,EAAE,CAAC;QACnC,IAAI,CAAC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;IAC9B,CAAC;IAEM,+BAAY,GAAnB;QACE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YACrC,mBAAmB,EAAE,IAAI;YACzB,OAAO,EAAE,YAAY;SACtB,CAAC,CAAC;QACH,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IACzB,CAAC;IAEO,8BAAW,GAAnB;QACE,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IACzB,CAAC;IAED,8BAAW,GAAX;QACE,IAAI,KAAK,GAAe,IAAI,UAAU,CAAC,OAAO,EAAE,EAAC,OAAO,EAAE,KAAK,EAAC,CAAC,CAAC;QAClE,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IACpD,CAAC;IAED,uCAAoB,GAApB;QAAA,iBA4BC;QA3BC,IAAM,YAAY,GAAqB,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC;QACpE,IAAI,KAAK,GAAW,YAAY,CAAC,KAAK,CAAC,MAAM,CAAC;QAC9C,IAAI,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAC9B,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;YACd,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC/B,QAAQ,CAAC,MAAM,CAAC,SAAS,EAAE,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;YACzD,CAAC;YACD,IAAI,UAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC;YAC1C,EAAE,CAAC,CAAC,CAAC,UAAQ,CAAC;gBAAC,UAAQ,GAAG,CAAC,CAAC,CAAC;YAC7B,QAAQ,CAAC,GAAG,CAAC,UAAU,EAAE,UAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC9C,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,gBAAM;gBAC9C,EAAE,CAAC,CAAC,MAAM,CAAC,OAAO,KAAK,IAAI,CAAC,CAAC,CAAC;oBAC5B,KAAI,CAAC,WAAW,CAAC,KAAK,GAAG,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;oBAClD,EAAE,CAAC,CAAC,KAAI,CAAC,IAAI,CAAC,KAAK,KAAK,uFAAS,CAAC,KAAK,CAAC,CAAC,CAAC;wBACxC,KAAI,CAAC,IAAI,CAAC,aAAa,CAAC,UAAQ,CAAC,CAAC;oBACpC,CAAC;oBACD,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;wBAClB,KAAI,CAAC,cAAc,CAAC,kBAAkB,GAAG,MAAM,CAAC,KAAK;4BACjD,WAAW,EAAE,qCAAqC,CAAC;oBACzD,CAAC;gBACH,CAAC;gBACD,EAAE,CAAC,CAAC,MAAM,CAAC,OAAO,KAAK,KAAK,CAAC,CAAC,CAAC;oBAC7B,KAAI,CAAC,cAAc,CAAC,yBAAyB,EAAE,+BAA+B,CAAC;gBACjF,CAAC;gBACD,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC;YAC5B,CAAC,CAAC,CAAC;QACL,CAAC;IACH,CAAC;IAEO,iCAAc,GAAtB,UAAuB,KAAa,EAAE,QAAgB;QACpD,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAChC,KAAK,EAAE,KAAK;YACZ,QAAQ,EAAE,QAAQ;YAClB,OAAO,EAAE,CAAC,SAAS,CAAC;SACrB,CAAC,CAAC;QACH,KAAK,CAAC,OAAO,EAAE,CAAC;IAClB,CAAC;IAED,yBAAM,GAAN;QACE,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;QACnB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;IACtC,CAAC;IAED,iCAAc,GAAd;QAAA,iBAUC;QATC,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,CAAC,IAAI,CAAC,kBAAQ;YACvC,EAAE,CAAC,CAAC,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC;gBACtB,KAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE,CAAC,SAAS,CACvC,gBAAM,IAAI,YAAI,CAAC,WAAW,GAAG,KAAI,CAAC,IAAI,CAAC,QAAQ,EAArC,CAAqC,CAClD,CAAC;YACJ,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,KAAI,CAAC,MAAM,EAAE,CAAC;YAChB,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IACH,eAAC;AAAD,CAAC;AA5GyB;IAAvB,yFAAS,CAAC,WAAW,CAAC;;2CAAW;AAFvB,QAAQ;IALpB,uFAAS,EAAE;IACX,wFAAS,CAAC;QACT,QAAQ,EAAE,WAAW;OACG;KACzB,CAAC;sJAS0B,CAAsD;QACpD,sEAAoC,EAAiB;QAClD,KAAe;AAoG/C;SA9GY,QAAQ,e","file":"4.main.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { MainPage } from './main';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    MainPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(MainPage),\r\n  ],\r\n  exports: [\r\n    MainPage\r\n  ]\r\n})\r\nexport class MainPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/main.module.ts","import {Component, ViewChild} from '@angular/core';\r\nimport {AlertController, IonicPage, Loading, LoadingController, NavController} from 'ionic-angular';\r\nimport {AuthServiceProvider, User} from \"../../providers/auth-service/auth-service\";\r\nimport {DataServiceProvider, PageState} from \"../../providers/data-service/data-service\";\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-main',\r\n  templateUrl: 'main.html',\r\n})\r\nexport class MainPage {\r\n\r\n  @ViewChild('fileInput') fileInput;\r\n\r\n  public activePage = \"DrivePage\";\r\n  private currentUser: User;\r\n  private loading: Loading;\r\n\r\n  constructor(private auth: AuthServiceProvider, private data: DataServiceProvider,\r\n              public navCtrl: NavController, private loadingCtrl: LoadingController,\r\n              private alertCtrl: AlertController) {\r\n    this.currentUser = this.auth.authUser;\r\n  }\r\n\r\n  goToTrash() {\r\n    this.data.state = PageState.DELETED;\r\n    this.transitionPage();\r\n    this.data.loadTrash(\r\n        () => this.displayWarning(\"Unable to load your drive.\", \"Please check your connection\"));\r\n    this.stopLoading();\r\n  }\r\n\r\n  goToFiles() {\r\n    this.data.state = PageState.FILES;\r\n    this.transitionPage();\r\n    this.data.enterFolder(-1, null,\r\n        () => this.displayWarning(\"Unable to load your drive.\", \"Please check your connection\"));\r\n    this.stopLoading();\r\n  }\r\n\r\n  private transitionPage() {\r\n    this.startLoading();\r\n    this.data.clearSelected();\r\n    this.data.currentFolder.folders = [];\r\n    this.data.currentFolder.files = [];\r\n    this.data.folderLevels = [];\r\n  }\r\n\r\n  public startLoading() {\r\n    this.loading = this.loadingCtrl.create({\r\n      dismissOnPageChange: true,\r\n      content: \"Loading...\"\r\n    });\r\n    this.loading.present();\r\n  }\r\n\r\n  private stopLoading() {\r\n    this.loading.dismiss();\r\n  }\r\n\r\n  chooseFiles() {\r\n    let event: MouseEvent = new MouseEvent('click', {bubbles: false});\r\n    this.fileInput.nativeElement.dispatchEvent(event);\r\n  }\r\n\r\n  fileInputChangeEvent() {\r\n    const inputElement: HTMLInputElement = this.fileInput.nativeElement;\r\n    let count: number = inputElement.files.length;\r\n    let formData = new FormData();\r\n    if (count > 0) {\r\n      for (let i = 0; i < count; i++) {\r\n        formData.append('files[]', inputElement.files.item(i));\r\n      }\r\n      let folderId = this.data.currentFolder.id;\r\n      if (!folderId) folderId = -1;\r\n      formData.set(\"folderId\", folderId.toString());\r\n      this.data.uploadFiles(formData).subscribe(result => {\r\n        if (result.success === true) {\r\n          this.currentUser.usage = parseFloat(result.usage);\r\n          if (this.data.state === PageState.FILES) {\r\n            this.data.refreshFolder(folderId);\r\n          }\r\n          if (result.failed) {\r\n            this.displayWarning(\"Error uploading \" + result.count +\r\n                \" file(s).\", \"Some files types are not supported.\")\r\n          }\r\n        }\r\n        if (result.success === false) {\r\n          this.displayWarning(\"Failed to upload files.\", \"Please check your connection.\")\r\n        }\r\n        inputElement.value = null;\r\n      });\r\n    }\r\n  }\r\n\r\n  private displayWarning(title: string, subTitle: string) {\r\n    let alert = this.alertCtrl.create({\r\n      title: title,\r\n      subTitle: subTitle,\r\n      buttons: ['Dismiss']\r\n    });\r\n    alert.present();\r\n  }\r\n\r\n  logout() {\r\n    this.auth.logout();\r\n    this.navCtrl.setRoot(\"WelcomePage\");\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    this.auth.isAuthenticated().then(hasToken => {\r\n      if (hasToken === true) {\r\n        this.auth.loadAuthenticatedUser().subscribe(\r\n            result => this.currentUser = this.auth.authUser\r\n        );\r\n      } else {\r\n        this.logout();\r\n      }\r\n    });\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/main.ts"],"sourceRoot":""}